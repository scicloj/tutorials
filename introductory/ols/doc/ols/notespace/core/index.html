<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.0/sandstone/bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.6.0/styles/solarized-light.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-grid.min.css" rel="stylesheet" type="text/css">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/ag-grid/24.0.0/styles/ag-theme-balham.min.css" rel="stylesheet" type="text/css">
        <link href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" rel="stylesheet" type="text/css">
    </head>
    <body>
        <p id="loading">Loading ...</p>
        <div id="app"></div>
    </body>
    <script src="https://cdn.jsdelivr.net/gh/scicloj/gorilla-notes@master/dist/0.5.0-SNAPSHOT-5/main.js"></script>
    <script>
     shadow.loader.load("main");
     gorilla_notes.main.main_BANG_(false, "{:options {:reverse-notes? false, :header? false, :notes-in-cards? false, :custom-header [:div {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} \"(notespace)\" [:p \"Sat Dec 12 22:47:05 IST 2020\"] nil nil [:hr]], :custom-footer [:div [:hr]]}, :ids [\"923\" \"924\" \"925\" \"926\" \"927\" \"928\" \"929\" \"930\" \"931\" \"932\" \"933\" \"934\" \"935\" \"936\" \"937\" \"938\" \"939\" \"940\"], :id->content {\"910\" [:div [:p/code {:code \"(defn stock-data-date-filter\\n  \\\"Parsing dates allows for easy filtering\\\"\\n  [yyyy-MM-dd]\\n  (ds/filter-column stock-data \\\"date\\\" #(.isAfter ^LocalDate % (LocalDate/parse yyyy-MM-dd))))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"932\" [:div nil [:div [:p/markdown \"## We will now go through examples\"]]], \"939\" [:div [:p/code {:code \"(ols-beta \\\"esu0\\\" \\\"vgu0\\\" stock-data)\", :bg-class \"bg-light\"}] [:div [:p/code {:code \"0.669367469325812\\n\"}]]], \"914\" [:div nil [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"930\" [:div [:p/code {:code \"(defn return-ols\\n  \\\"Smile OLS. Will include intercept by default. This is the object you want to query.\\n  Example queries if result is called ols:\\n  (.coefficients ols)\\n  (.RSquared ols)\\n  (.predict ols (double-array [1. 0.05])) ;you need the intercept here, set at 1.\\\"\\n  [y x dataset]\\n  (->> (ds/select-columns dataset [y x])\\n       (ds-returns)\\n       (ds-smile/dataset->dataframe)\\n       (OLS/fit (Formula/lhs ^String y))))\", :bg-class \"bg-light\"}] [:div nil]], \"913\" [:div [:p/code {:code \"(defn ols-beta\\n  \\\"Get straight to the beta\\\"\\n  [y x dataset]\\n  (nth (.coefficients ^LinearModel (return-ols y x dataset)) 1))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"923\" [:div nil [:div nil]], \"911\" [:div [:p/code {:code \"(defn ds-returns\\n  \\\"Gets returns for every column except date.\\n  In Python this would be df.pct_change()\\n  WARNING: without the last line, we get an array of same length with 0 in the first row - would nil be better?\\\"\\n  [dataset]\\n  (let [raw (reduce\\n              (fn [dts col] (assoc dts col (rolling/fixed-rolling-window (dts col) 2 (fn [[a b]] (dec (/ b a))))))\\n              dataset\\n              (remove #{\\\"date\\\"} (ds/column-names dataset)))]\\n    (ds/tail raw (dec (ds/row-count raw)))))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"927\" [:div [:p/code {:code \"(def stock-data\\n  \\\"We are explicitly parsing the dates.\\n  We are also explicitly parsing vgu0 as it comes as int by default, which will mess up the 333333333333333333333333333333333rns.\\\"\\n  ;TODO find a way to parse into float by default, except for some columns like date\\n  (ds/->dataset \\\"resources/clj-ols-data.csv\\\" {:parser-fn {\\\"date\\\" [:local-date \\\"yyyyMMdd\\\"]\\n                                                          \\\"vgu0\\\" :float32}}))\", :bg-class \"bg-light\"}] [:div nil]], \"908\" [:div nil [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"916\" [:div [:p/code {:code \"^kind/dataset\\n(ds/head (stock-data-date-filter \\\"2020-06-10\\\"))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"925\" [:div [:p/code {:code \"(comment\\n  ;; we'll be calling some Java methods\\n  ;; commenting this out, since it fails as a notespace note\\n  ;; (Can't set!: *warn-on-reflection* from non-binding thread)\\n  (set! *warn-on-reflection* true))\", :bg-class \"bg-light\"}] [:div [:p/code {:code \"nil\\n\"}]]], \"938\" [:div [:p/code {:code \"(.predict ^LinearModel (return-ols \\\"esu0\\\" \\\"vgu0\\\" stock-data) (double-array [1.0 0.05]))\", :bg-class \"bg-light\"}] [:div [:p/code {:code \"0.03440875994332247\\n\"}]]], \"924\" [:div nil [:div [:p/markdown \"Note we are using smile Java interop.\\nThere's a \\\"native\\\" Clojure implementation but more doc for the Java version, hence using that one.\"]]], \"921\" [:div [:p/code {:code \"(ols-beta \\\"esu0\\\" \\\"vgu0\\\" stock-data)\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"919\" [:div [:p/code {:code \"(.RSquared ^LinearModel (return-ols \\\"esu0\\\" \\\"vgu0\\\" stock-data))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"936\" [:div [:p/code {:code \"^kind/md ; rendering this as code inside markdown\\n[\\\"```\\\"\\n (return-ols \\\"esu0\\\" \\\"vgu0\\\" stock-data)\\n \\\"```\\\"]\", :bg-class \"bg-light\"}] [:div [:p/markdown \"```\\n#object[smile.regression.LinearModel 0x5d0b8d6b Linear Model:\\n\\nResiduals:\\n       Min          1Q      Median          3Q         Max\\n   -0.0714     -0.0067      0.0001      0.0068      0.0970\\n\\nCoefficients:\\n                  Estimate Std. Error    t value   Pr(>|t|)\\nIntercept           0.0009     0.0014     0.6875     0.4928 \\nvgu0                0.6694     0.0615    10.8755     0.0000 ***\\n---------------------------------------------------------------------\\nSignificance codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\\n\\nResidual standard error: 0.0176 on 163 degrees of freedom\\nMultiple R-squared: 0.4205,    Adjusted R-squared: 0.4169\\nF-statistic: 118.2771 on 2 and 163 DF,  p-value: 4.662e-21\\n]\\n```\"]]], \"918\" [:div [:p/code {:code \"^kind/md ; rendering this as code inside markdown\\n[\\\"```\\\"\\n (return-ols \\\"esu0\\\" \\\"vgu0\\\" stock-data)\\n \\\"```\\\"]\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"928\" [:div [:p/code {:code \"(defn stock-data-date-filter\\n  \\\"Parsing dates allows for easy filtering\\\"\\n  [yyyy-MM-dd]\\n  (ds/filter-column stock-data \\\"date\\\" #(.isAfter ^LocalDate % (LocalDate/parse yyyy-MM-dd))))\", :bg-class \"bg-light\"}] [:div nil]], \"915\" [:div [:p/code {:code \"^kind/dataset\\n(ds/head stock-data)\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"929\" [:div [:p/code {:code \"(defn ds-returns\\n  \\\"Gets returns for every column except date.\\n  In Python this would be df.pct_change()\\n  WARNING: without the last line, we get an array of same length with 0 in the first row - would nil be better?\\\"\\n  [dataset]\\n  (let [raw (reduce\\n              (fn [dts col] (assoc dts col (rolling/fixed-rolling-window (dts col) 2 (fn [[a b]] (dec (/ b a))))))\\n              dataset\\n              (remove #{\\\"date\\\"} (ds/column-names dataset)))]\\n    (ds/tail raw (dec (ds/row-count raw)))))\", :bg-class \"bg-light\"}] [:div nil]], \"935\" [:div [:p/code {:code \"^kind/dataset\\n(ds/head (ds-returns stock-data))\", :bg-class \"bg-light\"}] [:div [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"400px\"}} [:p/markdown \"resources/clj-ols-data.csv [5 4]:\\n\\n|       date |        esu0 |        vgu0 |      random |\\n|------------|-------------|-------------|-------------|\\n| 2020-01-03 | -0.00733393 | -0.00755328 | -0.00603378 |\\n| 2020-01-06 |  0.00256640 | -0.00407719 |  0.00425292 |\\n| 2020-01-07 | -0.00255983 |  0.00300218 | -0.00886798 |\\n| 2020-01-08 |  0.00785473 |  0.00299320 |  0.01610518 |\\n| 2020-01-09 |  0.00486130 |  0.00569723 | -0.00363002 |\\n\"]]]], \"926\" [:div nil [:div [:p/markdown \"We will be using closing prices for futures contract,\\nfor S&P500 e-mini September 2020, Eurostoxx 50, and a random combination of both.\\nOur file also has a column of dates in yyyyMMdd format.\"]]], \"909\" [:div [:p/code {:code \"(def stock-data\\n  \\\"We are explicitly parsing the dates.\\n  We are also explicitly parsing vgu0 as it comes as int by default, which will mess up the 333333333333333333333333333333333rns.\\\"\\n  ;TODO find a way to parse into float by default, except for some columns like date\\n  (ds/->dataset \\\"resources/clj-ols-data.csv\\\" {:parser-fn {\\\"date\\\" [:local-date \\\"yyyyMMdd\\\"]\\n                                                          \\\"vgu0\\\" :float32}}))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"906\" [:div nil [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"917\" [:div [:p/code {:code \"^kind/dataset\\n(ds/head (ds-returns stock-data))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"937\" [:div [:p/code {:code \"(.RSquared ^LinearModel (return-ols \\\"esu0\\\" \\\"vgu0\\\" stock-data))\", :bg-class \"bg-light\"}] [:div [:p/code {:code \"0.42050018964195\\n\"}]]], \"940\" [:div [:p/code {:code \"(ols-beta \\\"esu0\\\" \\\"random\\\" stock-data)\", :bg-class \"bg-light\"}] [:div [:p/code {:code \"0.8758305642013672\\n\"}]]], \"920\" [:div [:p/code {:code \"(.predict ^LinearModel (return-ols \\\"esu0\\\" \\\"vgu0\\\" stock-data) (double-array [1.0 0.05]))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"934\" [:div [:p/code {:code \"^kind/dataset\\n(ds/head (stock-data-date-filter \\\"2020-06-10\\\"))\", :bg-class \"bg-light\"}] [:div [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"400px\"}} [:p/markdown \"resources/clj-ols-data.csv [5 4]:\\n\\n|       date |     esu0 |   vgu0 |    random |\\n|------------|----------|--------|-----------|\\n| 2020-06-11 | 2990.500 | 3125.0 | 3038.7500 |\\n| 2020-06-12 | 3014.875 | 3112.0 | 3050.4375 |\\n| 2020-06-15 | 3053.000 | 3108.0 | 3080.5000 |\\n| 2020-06-16 | 3109.375 | 3212.0 | 3170.6875 |\\n| 2020-06-17 | 3098.250 | 3236.0 | 3174.1250 |\\n\"]]]], \"905\" [:div nil [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"922\" [:div [:p/code {:code \"(ols-beta \\\"esu0\\\" \\\"random\\\" stock-data)\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"933\" [:div [:p/code {:code \"^kind/dataset\\n(ds/head stock-data)\", :bg-class \"bg-light\"}] [:div [:div {:class \"table table-striped table-hover table-condensed table-responsive\", :style {:height \"400px\"}} [:p/markdown \"resources/clj-ols-data.csv [5 4]:\\n\\n|       date |     esu0 |   vgu0 |    random |\\n|------------|----------|--------|-----------|\\n| 2020-01-02 | 3238.375 | 3707.0 | 3459.6875 |\\n| 2020-01-03 | 3214.625 | 3679.0 | 3438.8125 |\\n| 2020-01-06 | 3222.875 | 3664.0 | 3453.4375 |\\n| 2020-01-07 | 3214.625 | 3675.0 | 3422.8125 |\\n| 2020-01-08 | 3239.875 | 3686.0 | 3477.9375 |\\n\"]]]], \"907\" [:div [:p/code {:code \"(comment\\n  ;; we'll be calling some Java methods\\n  ;; commenting this out, since it fails as a notespace note\\n  ;; (Can't set!: *warn-on-reflection* from non-binding thread)\\n  (set! *warn-on-reflection* true))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]], \"931\" [:div [:p/code {:code \"(defn ols-beta\\n  \\\"Get straight to the beta\\\"\\n  [y x dataset]\\n  (nth (.coefficients ^LinearModel (return-ols y x dataset)) 1))\", :bg-class \"bg-light\"}] [:div nil]], \"912\" [:div [:p/code {:code \"(defn return-ols\\n  \\\"Smile OLS. Will include intercept by default. This is the object you want to query.\\n  Example queries if result is called ols:\\n  (.coefficients ols)\\n  (.RSquared ols)\\n  (.predict ols (double-array [1. 0.05])) ;you need the intercept here, set at 1.\\\"\\n  [y x dataset]\\n  (->> (ds/select-columns dataset [y x])\\n       (ds-returns)\\n       (ds-smile/dataset->dataframe)\\n       (OLS/fit (Formula/lhs ^String y))))\", :bg-class \"bg-light\"}] [:div [:p {:style {:font-style \"italic\", :font-family \"\\\"Lucida Console\\\", Courier, monospace\"}} [:small \"(not evaluated yet)\"]]]]}}");
     document.getElementById("loading").remove();
    </script>
</html>
